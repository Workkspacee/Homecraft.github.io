<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" href="/bill.css">
</head>
<body>

    <!-- <div class="header1">
        <nav>
            <img src="/logo.png" alt="logo">
            <h3><a href="/logout">Log out</a></h3>
        </nav>
    </div> -->

    <div class="container">
        <table class="info" style="width:100%">
            <tr>
                <td>
                    <img src="/logo.png" alt="logo" height="120px">
                </td>
                <td align="right">
                    <h2>Homecraft</h2>
                    <p>Plot No. 521, Road No. 5, Near Paliwal Chowkdi, GIDC Sachin, Surat - 394230</p>
                    <p>Phone no.: +91-9328282823</p>
                    <p>GSTIN: 24ARFPR5413C1Z5, State: 24-Gujarat</p>
                </td>
            </tr>
        </table>

        <br>
        <center><h3>Tax Invoice</h3></center> 
        <br>
        <br>
        
        <form action="/bill" method="post">
            <nav class="details" style="display: flex; flex: 1 1 22%; min-width: 250px; justify-content: space-between; align-items: center;"> 
                <div style="padding-right: 20px;">
                    <h4>Bill To</h4><br>
                    <input type="text" class="input_field" placeholder="Name" name="name" value="<%= no.name %>" style="font-weight: 700;" />
                    <br>
                    <textarea name="add" cols="20"  placeholder="Address"><%= no.add %></textarea><br>
                    <label>Contact No: <input type="tel" class="input_field" maxlength="10" name="p_no" value="<%= no.p_no %>"></label><br>
                    <label>State: 
                        <select name="state" required>
                            <option value="">-- Select State --</option>
                            <option value="01 - Jammu and Kashmir" <%= no.state === '01 - Jammu and Kashmir' ? 'selected' : '' %>>1 - Jammu and Kashmir</option>
                            <option value="02 - Himachal Pradesh" <%= no.state === '02 - Himachal Pradesh' ? 'selected' : '' %>>2 - Himachal Pradesh</option>
                            <option value="03 - Punjab" <%= no.state === '03 - Punjab' ? 'selected' : '' %>>3 - Punjab</option>
                            <option value="04 - Chandigarh" <%= no.state === '04 - Chandigarh' ? 'selected' : '' %>>4 - Chandigarh</option>
                            <option value="05 - Uttarakhand" <%= no.state === '05 - Uttarakhand' ? 'selected' : '' %>>5 - Uttarakhand</option>
                            <option value="06 - Haryana" <%= no.state === '06 - Haryana' ? 'selected' : '' %>>6 - Haryana</option>
                            <option value="07 - Delhi" <%= no.state === '07 - Delhi' ? 'selected' : '' %>>7 - Delhi</option>
                            <option value="08 - Rajasthan" <%= no.state === '08 - Rajasthan' ? 'selected' : '' %>>8 - Rajasthan</option>
                            <option value="09 - Uttar Pradesh" <%= no.state === '09 - Uttar Pradesh' ? 'selected' : '' %>>9 - Uttar Pradesh</option>
                            <option value="10 - Bihar" <%= no.state === '10 - Bihar' ? 'selected' : '' %>>10 - Bihar</option>
                            <option value="11 - Sikkim" <%= no.state === '11 - Sikkim' ? 'selected' : '' %>>11 - Sikkim</option>
                            <option value="12 - Arunachal Pradesh" <%= no.state === '12 - Arunachal Pradesh' ? 'selected' : '' %>>12 - Arunachal Pradesh</option>
                            <option value="13 - Nagaland" <%= no.state === '13 - Nagaland' ? 'selected' : '' %>>13 - Nagaland</option>
                            <option value="14 - Manipur" <%= no.state === '14 - Manipur' ? 'selected' : '' %>>14 - Manipur</option>
                            <option value="15 - Mizoram" <%= no.state === '15 - Mizoram' ? 'selected' : '' %>>15 - Mizoram</option>
                            <option value="16 - Tripura" <%= no.state === '16 - Tripura' ? 'selected' : '' %>>16 - Tripura</option>
                            <option value="17 - Meghalaya" <%= no.state === '17 - Meghalaya' ? 'selected' : '' %>>17 - Meghalaya</option>
                            <option value="18 - Assam" <%= no.state === '18 - Assam' ? 'selected' : '' %>>18 - Assam</option>
                            <option value="19 - West Bengal" <%= no.state === '19 - West Bengal' ? 'selected' : '' %>>19 - West Bengal</option>
                            <option value="20 - Jharkhand" <%= no.state === '20 - Jharkhand' ? 'selected' : '' %>>20 - Jharkhand</option>
                            <option value="21 - Odisha" <%= no.state === '21 - Odisha' ? 'selected' : '' %>>21 - Odisha</option>
                            <option value="22 - Chhattisgarh" <%= no.state === '22 - Chhattisgarh' ? 'selected' : '' %>>22 - Chhattisgarh</option>
                            <option value="23 - Madhya Pradesh" <%= no.state === '23 - Madhya Pradesh' ? 'selected' : '' %>>23 - Madhya Pradesh</option>
                            <option value="24 - Gujarat" <%= no.state === '24 - Gujarat' ? 'selected' : '' %>>24 - Gujarat</option>
                            <option value="25 - Daman and Diu" <%= no.state === '25 - Daman and Diu' ? 'selected' : '' %>>25 - Daman and Diu</option>
                            <option value="26 - Dadra and Nagar Haveli" <%= no.state === '26 - Dadra and Nagar Haveli' ? 'selected' : '' %>>26 - Dadra and Nagar Haveli</option>
                            <option value="27 - Maharashtra" <%= no.state === '27 - Maharashtra' ? 'selected' : '' %>>27 - Maharashtra</option>
                            <option value="28 - Andhra Pradesh (Old)" <%= no.state === '28 - Andhra Pradesh (Old)' ? 'selected' : '' %>>28 - Andhra Pradesh (Old)</option>
                            <option value="29 - Karnataka" <%= no.state === '29 - Karnataka' ? 'selected' : '' %>>29 - Karnataka</option>
                            <option value="30 - Goa" <%= no.state === '30 - Goa' ? 'selected' : '' %>>30 - Goa</option>
                            <option value="31 - Lakshadweep" <%= no.state === '31 - Lakshadweep' ? 'selected' : '' %>>31 - Lakshadweep</option>
                            <option value="32 - Kerala" <%= no.state === '32 - Kerala' ? 'selected' : '' %>>32 - Kerala</option>
                            <option value="33 - Tamil Nadu" <%= no.state === '33 - Tamil Nadu' ? 'selected' : '' %>>33 - Tamil Nadu</option>
                            <option value="34 - Puducherry" <%= no.state === '34 - Puducherry' ? 'selected' : '' %>>34 - Puducherry</option>
                            <option value="35 - Andaman and Nicobar Islands" <%= no.state === '35 - Andaman and Nicobar Islands' ? 'selected' : '' %>>35 - Andaman and Nicobar Islands</option>
                            <option value="36 - Telangana" <%= no.state === '36 - Telangana' ? 'selected' : '' %>>36 - Telangana</option>
                            <option value="37 - Andhra Pradesh (New)" <%= no.state === '37 - Andhra Pradesh (New)' ? 'selected' : '' %>>37 - Andhra Pradesh (New)</option>
                            <option value="38 - Ladakh" <%= no.state === '38 - Ladakh' ? 'selected' : '' %>>38 - Ladakh</option>
                        </select>
                    </label>
                    <br><br>
                </div>

                <div style="padding-right: 40px;">
                    <h4>Ship To</h4><br>
                    <!-- <textarea name="add" cols="20" rows="3" placeholder="Address"><%= no.add %></textarea> -->  
                    <br><br><br><br><br>
                </div>
                <div style="padding-right: 40px;">
                    <h4>Transportation Details</h4><br>
                    <label>Driver Name: <input type="text" name="driver_name" class="input_field" placeholder="Name"/></label><br>
                    <label>Vehicle Number: <input type="text" name="v_no"  class="input_field" placeholder="GJ05FR9362"/></label><br>
                    <label>Delivery Date: <input type="date" name="d_date"  class="input_field" placeholder="date" /></label><br>
                    <label>Location:<input type="text" name="loc"  class="input_field" placeholder="Surat"></label><br>
                    <label>LR Number: <input type="text"  name="lr_no" class="input_field"></label>
                    <br><br>
                </div>
                <div> 
                    <h4>Invoice Details</h4><br>
                    <label>Invoice No:<input type="text" name="work_no" class="input_field" value="<%= no.work_no %>" readonly></label><br>
                    <label>Date: <input type="date" name="d_date" class="input_field"></label><br>
                    <label>Place of supply:<input type="text"  name="supply_place" class="input_field"></label><br>
                    <label>Due Date: <input type="date"  name="due_date" class="input_field"></label>
                    <br><br><br><br>
                </div>
            </nav>

            <table class="bill table-hover table-bordered">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Item Name</th>
                        <th>HSN/SAC</th>
                        <th>Quantity</th>
                        <th>Unit</th>
                        <th>Price/Unit</th>
                        <th>GST</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <% selectedRows.forEach((q, index) => { %>
                        <tr>
                            <td class="sr-no"><%= index + 1 %></td>
                            <td><input type="text" step="any" class="bill_table" name="material[]" value="<%= q.material || '' %>" style="font-weight: bold;"></td>
                            <td><input type="text" step="any" class="bill_table" name="q_hsn[]" value="<%= q.q_hsn || '' %>" style="width: 100%;"></td>
                            <td><input type="number" step="any" class="bill_table qty" name="qty[]" value="<%= q.qty || '' %>" style="width: 100%;"></td>
                            <td>Mtr</td>
                            <td><input type="number" step="any" class="bill_table q_rate" name="q_rate[]" value="<%= q.q_rate || '' %>" style="width: 100%;"></td>
                            <td><input type="number" step="any" class="bill_table" name="q_gst[]" value="<%= q.q_gst || '' %>" style="width: 100%;"></td>
                            <td><input type="number" step="any" class="bill_table grand_total" name="grand_total[]" value="<%= q.grand_total || '' %>" style="width: 100%;"></td>
                        </tr>
                    <% }) %>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td style="font-weight: bold;">Total</td>
                        <td></td>
                        <td><input type="number" step="any" class="bill_table" name="quantity_total" style="width: 100%;"></td>
                        <td></td>
                        <td></td>
                        <td><input type="number" step="any" class="bill_table" name="gst_total" style="width: 100%;"></td>
                        <td><input type="number" step="any" class="bill_table" name="amount" id="amount_total" style="width: 100%;"></td>
                    </tr>  <!--amount_total aa use karvani jarur nathi use Total Grand Total same j che-->
                </tbody>
            </table><br>

            <!--dont know how to make this table-->
            <table class="tax" style="width: 100%;">
                <tr>
                    <th>Tax Type</th>
                    <th>Taxable amount</th>
                    <th>Rate</th>
                    <th>Tax amount</th>
                    <th>Amounts</th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
                <tr>
                    <td>SGST</td>
                    <td><input type="number" step="any" class="bill_table" name="taxable_amount" id="taxable_amount_sgst" style="width: 30%;"></td>
                    <td>2.5%</td>
                    <td>₹ 936.50</td>
                    <td>Sub Total</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td>₹ 39,333.00</td> 
                </tr>
                <tr>
                    <td>CGST</td>
                    <td><input type="number" step="any" class="bill_table" name="taxable_amount" id="taxable_amount_cgst" style="width: 30%;"></td>
                    <td>2.5%</td>
                    <td><input type="number" step="any" class="bill_table" name="taxable_amount" id="cgst_amount" style="width: 30%;"></td>
                    <th style="background-color: #eee;">Total</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td style="background-color: #eee;">₹ 39,333.00</td> 
                </tr>
                <tr></tr>
                <tr></tr>
            </table><br>

            <table class="ivoice_words">
                <tr>
                    <th align="left"><h3>Invoice Amount In Words</h3></th>
                </tr>
                <tr></tr>
                <tr></tr><tr></tr>
                <tr>
                    <td>Thirty Nine Thousand Three Hundred Thirty Three Rupees only</td>
                </tr>
            </table><br>

            <table class="terms">
                <tr>
                    <td>
                        <h3>Terms and Conditions</h3>
                        <p>- We reserve the right of recovery before due date at any time.</p>
                        <p>- Goods once sold cannot be returned. Any defect in the material</p>
                        <p>received should be brought into notice withim the 48 hours of delivery.</p>
                        <p>- The sale is understood to have been made after due consideration of </p>
                        <p>the quality of goods and prevailing rates.</p>
                        <p>- The payment of this bill shall be made by the due date failing which interest</p>
                        <p>@ 1.5% Per Month shall be charged from the due date.</p>
                    </td>
                </tr>
            </table><br>

            <table style="width: 100%;">
                <tr>
                    <td>
                        <h3>Bank Details</h3><br>
                        <p>Name: HDFC BANK</p><br>
                        <p>Account No.: 50200023386178</p><br>
                        <p>IFSC code: HDFC0000955</p><br>
                        <p>Account holder's name: Homecraft</p><br>
                    </td>
                    <td>
                        <p>For: Homecraft</p>
                        <br><br><br>
                        <br><br>
                        <h3>Authorized Signatory</h3>
                    </td>
                </tr>
            </table><br>

            <center>
                <button type="submit" class="but">Submit</button>   
                <button type="button" class="but">Print</button>
            </center>
        </form>

    </div>

    <!-- <div class="footer">
        <nav>
            <p> &copy; 2024 All Rights Reserved.</p>
            <p>Designed with <i class="fas fa-heart" style="color:red"></i></p>
        </nav>
    </div> -->

</body>

<!-- To calculate total of quantity-->
<script>
  function calculateQuantityTotal() {
    let quantityInputs = document.querySelectorAll('input[name="qty[]"]');
    let total = 0;

    quantityInputs.forEach(input => {
      const value = parseFloat(input.value);
      if (!isNaN(value)) {
        total += value;
      }
    });

    const totalInput = document.querySelector('input[name="quantity_total"]');
    if (totalInput) {
      totalInput.value = total.toFixed(2); // Optional: round to 2 decimal places
    }
  }

  // Recalculate on input change
  document.addEventListener('input', function(e) {
    if (e.target.name === 'qty[]') {
      calculateQuantityTotal();
    }
  });

  // Also run on page load
  window.addEventListener('DOMContentLoaded', calculateQuantityTotal);
</script>

<!-- To calculate total amount-->
<script>
document.addEventListener('DOMContentLoaded', function () {
    function updateAmountTotal() {
        const grandTotals = document.querySelectorAll('.grand_total');
        let total = 0;
        grandTotals.forEach(input => {
            const value = parseFloat(input.value);
            if (!isNaN(value)) {
                total += value;
            }
        });
        document.getElementById('amount_total').value = total.toFixed(2);
    }

    // Run once on load
    updateAmountTotal();

    // Update total on input change
    document.querySelectorAll('.grand_total').forEach(input => {
        input.addEventListener('input', updateAmountTotal);
    });
});
</script>

<!-- To calculate total taxable amount-->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        function updateTaxableAmount() {
            const qtyInputs = document.querySelectorAll('.qty');
            const rateInputs = document.querySelectorAll('.q_rate');
            let totalTaxable = 0;

            for (let i = 0; i < qtyInputs.length; i++) {
                const qty = parseFloat(qtyInputs[i].value);
                const rate = parseFloat(rateInputs[i].value);
                if (!isNaN(qty) && !isNaN(rate)) {
                    totalTaxable += qty * rate;
                }
            }

            // Update both input fields
            const sgstField = document.getElementById('taxable_amount_sgst');
            const cgstField = document.getElementById('taxable_amount_cgst');

            if (sgstField) sgstField.value = totalTaxable.toFixed(2);
            if (cgstField) cgstField.value = totalTaxable.toFixed(2);
        }

        updateTaxableAmount();

        document.querySelectorAll('.qty, .q_rate').forEach(input => {
            input.addEventListener('input', updateTaxableAmount);
        });
    });
</script>

</html>